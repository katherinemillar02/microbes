---
title: "Distribution of Tephritid Pests"
editor: visual
---


```{r, echo=FALSE, message=FALSE}
library(leaflet)

locations <- data.frame(
  species = c("Ceratitis capitata", "Bactrocera dorsalis", "Ceratitis cosyra", "Ceratitis capitata", "Bactrocera tryoni"),
  country = c("Kenya", "Uganda", "Tanzania", "Western Australia", "Queensland"),
  lat = c(-1.3, 0.3, -6.8, -31.95, -22),
  lng = c(34.8, 32.5, 39.2, 115.86, 144),
  abundance = c(50, 80, 30, 70, 100)
)

species_colors <- c(
  "Ceratitis capitata" = "red",
  "Bactrocera dorsalis" = "blue",
  "Ceratitis cosyra" = "green",
  "Bactrocera tryoni" = "purple"
)

locations$color <- species_colors[locations$species]

legend_colors <- species_colors
legend_labels <- names(species_colors)

leaflet(data = locations) %>%
  addProviderTiles(providers$CartoDB.Positron) %>%
  addCircleMarkers(
    lng = ~lng,
    lat = ~lat,
    color = ~color,
    fillColor = ~color,
    fillOpacity = 0.7,
    radius = ~sqrt(abundance),
    popup = ~paste0(
      "<b>Species:</b> ", species, "<br>",
      "<b>Country:</b> ", country, "<br>",
      "<b>Abundance:</b> ", abundance
    ),
    label = ~species,
    clusterOptions = markerClusterOptions()
  ) %>%
  addLegend(
    position = "bottomright",
    colors = legend_colors,
    labels = legend_labels,
    title = "Tephritid Species"
  )


```