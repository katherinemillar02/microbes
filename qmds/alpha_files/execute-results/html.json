{
  "hash": "cfe31d60b296def8bf3299097ca3c458",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Alpha Diversity Analysis Methods\"\nabout:\n  template: marquee\n  links:\n    - icon: envelope\n      text: Email\n      href: mailto:Katie.millar@uea.ac.uk\n    - icon: github\n      text: Github\n      href: https://github.com/katherinemillar02\n    - text: Bluesky\n      href: https://bsky.app/profile/katiemillar.bsky.social\n    - icon: linkedin\n      text: LinkedIn\n      href: https://www.linkedin.com/in/katie-millar-15bb56236/\neditor: \n  markdown: \n    wrap: 72\n---\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![This image was generated from ChatGPT.](images/beta1.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n# What is Alpha Diversity?\n\nAlpha diversity, is diversity **within** a sample. It how diverse or\nrich your microbiome sample is in terms of different microorganisms.\n\nTwo important things are focused on:\n\n-   **Species richness**: the number of different species present in a\n    sample. Abundance of species, nor their relative distributions are\n    considered.\n-   **Species eveness**: a measure of relative abundance of different\n    species that make up richness.\n\n#### **Common Alpha Diversity Metrics:**\n\n-   **CHAO1 Index:** a non-parametric estimator used to estimate species\n    richness (the total number of species actually in a community).\n    Which is especially important when some species are rare and may not\n    be observed.\n-   **Shannon Index:** a measure of diversity within a community, that\n    considers both species richness and evenness. This is more sensitive\n    to the presence of rare species. A higher Shannon index indicates\n    greater diversity within a community.\n-   **Simpson Index:** a measure of diversity within a community, that\n    considers both species richness and evenness. This is more sensitive\n    to the dominance of a few species. A higher Simpson index indicates\n    greater diversity within a community.\n\n¬†\n\nNow let's take some time to go into each of these methods in detail:\n\n# CHAO1 Index\n\nThe **CHAO1 Index** is a **non-parametric** estimator used to measure\n**species richness**, focusing on the total number of Operational\nTaxonomic Units (OTUs), or Amplicon Sequence Variance (ASVs) in a\nsample. It is particularly useful in microbiome research, where the data\nare often highly skewed and many species are rare or underrepresented.\n\nTo put it in simple words, the CHAO1 index is brilliant for identifying\nrare species. To be specific it accounts for species that only appear\nonce (singletons) or twice (doubletons) in a dataset, showing true total\nspecies richness.\n\nThe CHAO1 Index formula is:\n\n$$\n\\text{CHAO1} = S_{\\text{obs}} + \\frac{F_1^2}{2F_2}\n$$ ¬†\n\n$$\n S_{\\text{obs}}= \\text{Number of observed species (ASVs or OTUS)}\n$$\n\n$$\nF_{1} = \\text{Number of singleton species (species observed only once)}\n$$\n\n$$\nF_{2} = \\text{Number of doubleton species (species observed only twice)}\n$$ ¬†\n\n### CHAO1 Index in action:\n\nLet's use this with some bacteria we found in the [Darrington et al.\n(2022)](https://www.microbiologyresearch.org/content/journal/mgen/10.1099/mgen.0.000801#tab2)\ndataset. This is based on relative proportions of bacteria, but that has\nbeen regenerated to generate total counts of bacteria.\n\n::: columns\n**Medfly from Morocco (Argan üå∞)**\n\n*Bacterial composition counts, these counts are generated based on\nrelative proportions:*\n\n| Bacterium          | Count |\n|--------------------|-------|\n| *Klebsiella*       | 270   |\n| *Pantonea*         | 54    |\n| *Commensalibacter* | 36    |\n| *Spingomonas*      | 1     |\n| *Serratia*         | 1     |\n| *Acinetobacter*    | 2     |\n| *Delftia*          | 1     |\n:::\n\n\n¬†\n\nWe first find our F~1~ values, these are our singletons - bacteria in\nour sample that only appear once. In our sample, we only have 3 of these\n(*Spingomonas*, *Serratia* and *Delftia*). $$\nF_1 = 3 \\\\\n$$ We then find our F~2~ values, these are our doubletons - bacteria in\nour sample that only appear twice In our sample, we only have 1 of these\n( *Acinetobacter*). $$ ¬† \nF_2 = 1 \\\\\n$$ ¬†\n\nNow, let's plug these into our **CHAO1** formula: $$\n\\begin{align*}\n\\text{CHAO1} &= 5 + \\frac{3^2}{2 \\times 1} \\\\\n             &= 5 + \\frac{9}{2} \\\\\n             &= 5 + 4.5 = 9.5\n\\end{align*}\n$$\n\n$$\n\\text{CHAO1}  = 9.5 \n$$ ¬†\n\n#### **What does this value mean?**\n\nA CHAO1 index value of **9.5** means the estimated total species\nrichness (or number of OTUs/ASVs) in the sample is about 9.5 species.\nAlthough we saw there were 7 different species, our CHAO1 index tells us\nthat there is likely a few more species that were not detected. This\nestimates reflects the statistical calculation.\n\nCHAO1 has told us about, rare - possibly underrepresented samples.\nKeeping on the topic of investigating for rare species, I introduce to\nyou; the **Shannon Diversity Index**. Although this metric is a measure\nof both species richness and eveness, it has a paritcular focus on\nrareity in samples.\n\n# Shannon Diversity Index\n\nThe Shannon Diversity Index accounts for both, how many species are\npresent, and how evenly they are distributed. It summarises the\ndiversity in the population while assuming all species are represented\nin a sample. Both for species richness and evenness.\n\nThe Shannon Diveristy formula:\n\n$$\nH' = -\\sum_{i=1}^{S} p_i \\log p_i\n$$\n\n$$\n {\\text{H'}}= \\text{Shannon diversity index}\n$$\n\n$$\n {\\text{S}}= \\text{Total number of species}\n$$\n\n$$\n p_{\\text{i}}= \\text{Relative proportion of individuals belonging to the species}\n$$\n\nLet's see this in action using this dataset:\n\n::: columns\n**Sample 1 - Medfly from Morocco (Argan üå∞)**\n\n**Bacterial composition (relative proportions):**\n\n| Bacterium          | Count |\n|--------------------|-------|\n| *Klebsiella*       | 270   |\n| *Pantonea*         | 54    |\n| *Commensalibacter* | 36    |\n| *Spingomonas*      | 1     |\n| *Serratia*         | 1     |\n| *Acinetobacter*    | 2     |\n| *Delftia*          | 1     |\n:::\n\n\nLet's first compute our relative proportions:\n\nOur total count is: 270+54+36+1+1+2+1=365\n\n| Bacterium          | Count | p~i~             |\n|--------------------|-------|------------------|\n| *Klebsiella*       | 270   | 270/365 = 0.7397 |\n| *Pantonea*         | 54    |  0.1479        |\n| *Commensalibacter* | 36    |0.0986                  |\n| *Spingomonas*      | 1     | 0.0027                 |\n| *Serratia*         | 1     |   0.0027               |\n| *Acinetobacter*    | 2     |    0.0055              |\n| *Delftia*          | 1     |  0.0027                |\n\n\n\n$$\n\\begin{aligned}\n&-0.7397 \\times \\log(0.7397) = 0.2221 \\\\\n&-0.1479 \\times \\log(0.1479) = 0.2812 \\\\\n&-0.0986 \\times \\log(0.0986) = 0.2280 \\\\\n&-0.0027 \\times \\log(0.0027) = 0.0166 \\\\\n&-0.0027 \\times \\log(0.0027) = 0.0166 \\\\\n&-0.0055 \\times \\log(0.0055) = 0.0305 \\\\\n&-0.0027 \\times \\log(0.0027) = 0.0166 \\\\\n& \\\\\n&H' = 0.2221 + 0.2812 + 0.2280 + 0.0166 + 0.0166 + 0.0305 + 0.0166 = \\boxed{0.8116}\n\\end{aligned}\n$$\n\n\n\n\nLet's test our R understanding by running it in there.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vegan)\nbacteria_counts <- c(\n  Klebsiella = 270,\n  Pantonea = 54,\n  Commensalibacter = 36,\n  Spingomonas = 1,\n  Serratia = 1,\n  Acinetobacter = 2,\n  Delftia = 1\n)\n\nshannon <- diversity(bacteria_counts, index = \"shannon\")\nshannon\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8112068\n```\n\n\n:::\n:::\n\n\nVery cool, the R function confirms R calculations!\n\n\n\n\n#### **What does this value mean?**\n\nThere is no strict limit of the Shannon Index, but limits can be from 0\n(this would mean very low diversity), upwards of around 3 or 4 (meaning\nvery high diversity). So our value of 0.7 would mean while there are clearly multiple\nspecies within our sample, there is uneven distribution and our diversity\nis not the highest.\n\nHopefully now that we understand the Shannon Index, we can move onto the final metric we are looking at, this is the Simpson Index. Like the Shannon index, it is a measure of diversity within a community, but rather than focusing on more rare species, it focuses on the more dominant species. \n\n# Simpson's Index\n\nThe Simpson Diversity Index is used to calculate a measure of diversity,\nwhich takes into account the number of taxa, as well as abundance. If\none type of microorganism dominates the sample - the simpson index will\nshow lower diversity. Only a few rare species will not effect the\ndiversity of a sample.\n\n$$\nD = 1 - _{}^{} \\frac{n(n - 1)}{N(N - 1)}\n$$\n\n$$\n {\\text{D}}= \\text{Simpson's Index}\n$$\n\n$$\n {\\text{n}}= \\text{Number of individuals in single species}\n$$\n\n$$\n {\\text{N}}= \\text{Number of individuals in total population}\n$$\n\nLet's use our count data from earlier!\n\n::: columns\n**Sample 1: Medfly from Morocco (Argan üå∞)**\n\n**Bacterial composition (relative proportions), these counts are\ngenerated based on relative proportions:**\n\n| Bacterium          | Count (n) | n(n-1)          |\n|--------------------|-----------|-----------------|\n| *Klebsiella*       | 270       | 72,630          |\n| *Pantonea*         | 54        | 2,862           |\n| *Commensalibacter* | 36        | 1,260           |\n| *Spingomonas*      | 1         | 0               |\n| *Serratia*         | 1         | 0               |\n| *Acinetobacter*    | 2         | 2               |\n| *Delftia*          | 1         | 0               |\n| **Total**          | N = 365   | n(n-1) = 76,752 |\n\n$$\nD = 1 - \\frac{76752}{365(364)} = \\frac{76752}{132860} = 0.5776908\n$$ \n\n\n$$\nD = 1 - 0.5776908 = 0.4223092\n$$\n:::\n\nCool, our simpson's index is **0.4223092**\n\nNow, I will be showing you how to do this in R. Using the `vegan()`\npackage introduced earlier.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Let's first put these counts into a dataframe. \nbacteria_counts <- c(\n  Klebsiella = 270,\n  Pantonea = 54,\n  Commensalibacter = 36,\n  Spingomonas = 1,\n  Serratia = 1,\n  Acinetobacter = 2,\n  Delftia = 1)\n\n# Then, using vegan(), we use diversity(), with the index \"simpson\" \nlibrary(vegan)\nsimpson_index <- diversity(bacteria_counts, index = \"simpson\")\n\nsimpson_index\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4211372\n```\n\n\n:::\n:::\n\n\n\nBoth calculating it ourselves, and using the R function, we get 0.42 -\nnice one!\n\n# Test your understanding!\n\n------------------------------------------------------------------------\n\n**What does Shannon Diversity look for?**\n\n::: {#quiz1}\n<form id=\"quiz-form-1\">\n\n<input type=\"radio\" name=\"q1\" value=\"a\"> A. Species richness only<br>\n<input type=\"radio\" name=\"q1\" value=\"b\"> B. Species evenness and\nrichness, with a focus on rare species<br> <input type=\"radio\" name=\"q1\" value=\"c\"> C. Only species\nevenness<br> <input type=\"radio\" name=\"q1\" value=\"d\"> D. Genetic\ndiversity within species<br><br>\n<button type=\"button\" onclick=\"checkAnswer1()\">Submit</button>\n\n</form>\n\n::: {#result1 style=\"margin-top: 1em; font-weight: bold;\"}\n:::\n:::\n\n\n\n\n\n```{=html}\n<script>\nfunction checkAnswer1() {\n  const answer = document.querySelector('#quiz-form-1 input[name=\"q1\"]:checked');\n  const result = document.getElementById(\"result1\");\n\n  if (!answer) {\n    result.textContent = \"‚ö†Ô∏è Please select an answer.\";\n    result.style.color = \"orange\";\n    return;\n  }\n\n  if (answer.value === \"b\") {\n    result.textContent = \"‚úÖ Correct! Shannon Diversity accounts for both species richness and evenness.\";\n    result.style.color = \"green\";\n  } else {\n    result.textContent = \"‚ùå Not quite, try again.\";\n    result.style.color = \"red\";\n  }\n}\n</script>\n```\n\n\n\n\n\n\n\n\n\n------------------------------------------------------------------------\n\n**What does the CHAO1 index look for?**\n\n<div>\n\n<form id=\"quiz-form-2\">\n\n<input type=\"radio\" name=\"q2\" value=\"a\"> A. Species richness, with a\nparticular focus on rare species<br>\n<input type=\"radio\" name=\"q2\" value=\"b\"> B. Measures species\nevenness<br> <input type=\"radio\" name=\"q2\" value=\"c\"> C. Measures\ngenetic diversity within species<br>\n<input type=\"radio\" name=\"q2\" value=\"d\"> D. Estimates species turnover\nbetween communities<br><br>\n\n<button type=\"button\" onclick=\"checkAnswer2()\">\nSubmit\n</button>\n</form>\n\n::: {#result2 style=\"margin-top: 1em; font-weight: bold;\"}\n:::\n\n</div>\n\n\n\n\n```{=html}\n<script>\nfunction checkAnswer2() {\n  const answer = document.querySelector('#quiz-form-2 input[name=\"q2\"]:checked');\n  const result = document.getElementById(\"result2\");\n\n  if (!answer) {\n    result.textContent = \"‚ö†Ô∏è Please select an answer.\";\n    result.style.color = \"orange\";\n    return;\n  }\n\n  if (answer.value === \"a\") {\n    result.textContent = \"‚úÖ Correct! CHAO1 estimates species richness, including unseen rare species.\";\n    result.style.color = \"green\";\n  } else {\n    result.textContent = \"‚ùå Not quite, try again.\";\n    result.style.color = \"red\";\n  }\n}\n</script>\n```\n\n\n\n------------------------------------------------------------------------\n\n\n**What does the Simpson Index look for?**\n\n<div>\n\n<form id=\"quiz-form-3\">\n\n<input type=\"radio\" name=\"q3\" value=\"a\"> A. Measures the proportion of endemic species unique to a geographic area <br>\n<input type=\"radio\" name=\"q3\" value=\"b\"> B. Measures species richness and\nevenness, with a focus on dominant species <br> <input type=\"radio\" name=\"q3\" value=\"c\"> C. Measures\ngenetic diversity within species<br>\n<input type=\"radio\" name=\"q3\" value=\"d\"> D.  Measures species richness and\nevenness, with a focus on rare species <br><br>\n\n<button type=\"button\" onclick=\"checkAnswer3()\">\nSubmit\n</button>\n</form>\n\n::: {#result3 style=\"margin-top: 1em; font-weight: bold;\"}\n:::\n\n</div>\n\n\n\n\n```{=html}\n<script>\nfunction checkAnswer2() {\n  const answer = document.querySelector('#quiz-form-3 input[name=\"q3\"]:checked');\n  const result = document.getElementById(\"result3\");\n\n  if (!answer) {\n    result.textContent = \"‚ö†Ô∏è Please select an answer.\";\n    result.style.color = \"orange\";\n    return;\n  }\n\n  if (answer.value === \"b\") {\n    result.textContent = \"‚úÖ Correct! Simpsons index does  look for genetic diversity based on species richness and evenness, but with a focus on dominant species.\";\n    result.style.color = \"green\";\n  } else {\n    result.textContent = \"‚ùå Not quite, try again.\";\n    result.style.color = \"red\";\n  }\n}\n</script>\n```\n\n\n\n------------------------------------------------------------------------\n\n**Both Shannon‚Äôs and Simpson‚Äôs indices measure community diversity by considering both species evenness and richness. What is the key difference between them?**\n\n<div>\n\n<form id=\"quiz-form-4\">\n\n<input type=\"radio\" name=\"q4\" value=\"a\"> \nA. Shannon‚Äôs index is calculated only from the number of species, while Simpson‚Äôs index is calculated only from the abundance of species. <br>\n<input type=\"radio\" name=\"q4\" value=\"b\"> \nB. Simpson's focuses more on dominant species, Shannon's focuses more on rare species <br> \n<input type=\"radio\" name=\"q4\" value=\"c\">\nC.  Shannon‚Äôs index increases as the number of dominant species increases, while Simpson‚Äôs index decreases.<br>\n<input type=\"radio\" name=\"q4\" value=\"d\"> \nD. Shannon‚Äôs index uses a logarithmic scale, while Simpson‚Äôs index uses an exponential scale <br><br>\n\n<button type=\"button\" onclick=\"checkAnswer4()\">\nSubmit\n</button>\n</form>\n\n::: {#result4 style=\"margin-top: 1em; font-weight: bold;\"}\n:::\n\n</div>\n\n\n\n\n```{=html}\n<script>\nfunction checkAnswer4() {\n  const answer = document.querySelector('#quiz-form-4 input[name=\"q4\"]:checked');\n  const result = document.getElementById(\"result4\");\n\n  if (!answer) {\n    result.textContent = \"‚ö†Ô∏è Please select an answer.\";\n    result.style.color = \"orange\";\n    return;\n  }\n\n  if (answer.value === \"b\") {\n    result.textContent = \"‚úÖ Correct!\";\n    result.style.color = \"green\";\n  } else {\n    result.textContent = \"‚ùå Not quite, try again.\";\n    result.style.color = \"red\";\n  }\n}\n</script>\n```\n\n\n\n------------------------------------------------------------------------\n\n<p>Congratulations! You have now completed learning about Alpha\nDiversity, please click the button below to begin learning about Beta\nDiversity Analysis methods!</p>\n\n::: {style=\"text-align: right; margin-top: 2em;\"}\n<a href=\"beta.qmd\" class=\"btn btn-primary\" role=\"button\"> Turn to Beta\nDiversity ‚Üí</a>\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}